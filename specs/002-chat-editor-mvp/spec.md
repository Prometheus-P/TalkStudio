# Feature Specification: TalkStudio Chat Editor MVP

**Feature Branch**: `002-chat-editor-mvp`
**Created**: 2025-12-11
**Status**: Draft
**Input**: User description: "TalkStudio MVP - 톡썰 스타일 대화 이미지 에디터. 브라우저에서 카톡/디스코드/인스타 DM 스타일의 가상 대화 UI를 커스텀하고 이미지로 저장하는 에디터"

## Clarifications

### Session 2025-12-11

- Q: 프로젝트당 최대 발화자 수는? → A: 최대 10명 (중규모 그룹 채팅 지원)
- Q: 이미지 Export 해상도 옵션은? → A: 1x/2x/3x 선택 가능 (사용자 옵션 제공)
- Q: 프로젝트 자동 저장 동작은? → A: 변경 시마다 자동 저장 (debounce 적용)

---

## Executive Summary

TalkStudio는 사용자가 브라우저에서 가상의 메신저 대화 UI를 자유롭게 커스텀하고, 그 화면을 이미지(PNG/WEBP)로 저장·다운로드할 수 있는 "톡썰 에디터"입니다. MVP는 **프론트엔드 SPA만으로 완성**하며, 백엔드/DB는 v2에서 필요시 추가합니다.

### MVP 범위

**포함됨:**
- 대화 캔버스 (카톡/디스코드/인스타 DM 스타일 렌더링)
- 메시지 타임라인 편집 (추가/삭제/수정/순서변경)
- 테마/프리셋 (카톡, 디스코드, 인스타 DM 등)
- 이미지 Export (PNG/WebP)
- 로컬 저장 (브라우저 스토리지)

**v2 이후 (MVP 범위 밖):**
- 디스코드/텔레그램/카톡/인스타 실제 연동
- Upstage/LLM AI 연동
- 계정/로그인 시스템
- 클라우드 저장/공유 링크
- 유료 플랜/과금

---

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 기본 대화 생성 및 이미지 저장 (Priority: P1)

콘텐츠 크리에이터가 SNS에 올릴 "톡썰" 이미지를 만들기 위해 에디터에 접속한다. 새 프로젝트를 시작하고, 대화 참여자(나/상대방)를 설정한 뒤, 메시지를 하나씩 입력하여 대화를 구성한다. 완성된 대화를 PNG 이미지로 다운로드하여 SNS에 공유한다.

**Why this priority**: 이것이 제품의 핵심 가치이며, 이 기능만으로도 사용자에게 완전한 가치를 제공할 수 있다.

**Independent Test**: 새 프로젝트 생성 → 메시지 3개 추가 → 이미지 다운로드까지의 전체 플로우를 테스트하여 "완성된 톡썰 이미지"라는 결과물을 얻을 수 있다.

**Acceptance Scenarios**:

1. **Given** 사용자가 에디터 페이지에 접속한 상태, **When** "새 프로젝트" 버튼을 클릭, **Then** 빈 대화 캔버스가 표시되고 메시지 입력이 가능해진다
2. **Given** 빈 대화 캔버스가 있는 상태, **When** 발화자를 선택하고 텍스트를 입력한 뒤 "추가"를 클릭, **Then** 새 메시지가 캔버스에 말풍선으로 표시된다
3. **Given** 메시지가 1개 이상 있는 캔버스, **When** "이미지 저장" 버튼을 클릭, **Then** 현재 캔버스가 PNG 이미지로 브라우저에 다운로드된다
4. **Given** 대화가 구성된 캔버스, **When** 메시지 옆의 삭제 버튼을 클릭, **Then** 해당 메시지가 캔버스에서 제거된다

---

### User Story 2 - 테마/프리셋으로 스타일 변경 (Priority: P2)

사용자가 "카톡 느낌"의 대화를 만들다가 "디스코드 느낌"으로 바꾸고 싶다. 테마 선택 영역에서 다른 프리셋을 선택하면, 색상/폰트/말풍선 스타일이 한 번에 변경된다.

**Why this priority**: 다양한 플랫폼 스타일을 제공하는 것이 제품 차별화 포인트이며, P1 기능이 완성된 후 가장 높은 사용자 만족도 향상을 가져온다.

**Independent Test**: 기본 테마로 메시지 작성 → 테마 변경 → 변경된 스타일로 이미지 저장까지 테스트하여 테마 기능의 독립적 가치를 검증한다.

**Acceptance Scenarios**:

1. **Given** 기본 테마로 대화가 구성된 상태, **When** 사이드바에서 "디스코드" 테마를 선택, **Then** 캔버스의 배경색, 말풍선 색상, 폰트 스타일이 디스코드 스타일로 즉시 변경된다
2. **Given** 테마가 변경된 상태, **When** 새 메시지를 추가, **Then** 새 메시지도 현재 선택된 테마 스타일로 표시된다
3. **Given** 어떤 테마든 선택된 상태, **When** 다른 테마로 변경, **Then** 기존에 입력한 메시지 내용은 유지되고 스타일만 변경된다

---

### User Story 3 - 메시지 순서 변경 및 수정 (Priority: P2)

사용자가 대화를 구성하던 중 메시지 순서를 바꾸거나 오타를 수정하고 싶다. 메시지를 드래그하여 순서를 변경하거나, 메시지를 클릭하여 내용을 수정할 수 있다.

**Why this priority**: 실수를 쉽게 고칠 수 있는 UX는 사용자 만족도와 작업 효율에 직접적으로 영향을 미친다.

**Independent Test**: 메시지 3개 생성 → 순서 변경 → 내용 수정 → 이미지 저장으로 편집 기능의 독립적 가치를 검증한다.

**Acceptance Scenarios**:

1. **Given** 메시지 A, B, C 순서로 3개가 있는 상태, **When** 메시지 C를 드래그하여 A 위로 이동, **Then** 순서가 C, A, B로 변경되어 캔버스에 표시된다
2. **Given** 메시지가 있는 상태, **When** 메시지를 클릭(또는 편집 버튼 클릭), **Then** 해당 메시지의 텍스트를 수정할 수 있는 입력 필드가 활성화된다
3. **Given** 메시지 편집 모드, **When** 텍스트를 수정하고 저장, **Then** 캔버스에 수정된 내용이 즉시 반영된다

---

### User Story 4 - 발화자 및 메시지 스타일 커스터마이징 (Priority: P3)

사용자가 발화자별로 이름, 프로필 이미지, 말풍선 색상을 개별 설정하고 싶다. 또한 특정 메시지를 강조 표시하거나 시스템 메시지로 표시하고 싶다.

**Why this priority**: 세부 커스터마이징은 고급 사용자의 니즈를 충족시키며, 기본 기능 완성 후 추가하면 된다.

**Independent Test**: 발화자 2명 설정(이름/색상) → 각각 메시지 작성 → 시스템 메시지 추가 → 이미지 저장으로 커스터마이징 기능을 검증한다.

**Acceptance Scenarios**:

1. **Given** 에디터가 열린 상태, **When** "발화자 설정" 패널에서 이름을 "철수"로 변경, **Then** 해당 발화자의 모든 메시지에 "철수"라는 이름이 표시된다
2. **Given** 발화자 설정 패널, **When** 프로필 이미지를 업로드, **Then** 해당 발화자의 메시지 옆에 업로드한 이미지가 프로필로 표시된다
3. **Given** 메시지 입력 시, **When** 메시지 타입을 "시스템 메시지"로 선택, **Then** 중앙 정렬된 회색 계열의 시스템 메시지 스타일로 표시된다
4. **Given** 상단 바 설정 패널, **When** 시간/배터리/Wi-Fi 표시를 on/off 토글, **Then** 캔버스 상단 바에 해당 요소가 표시되거나 숨겨진다

---

### User Story 5 - 프로젝트 저장 및 불러오기 (Priority: P3)

사용자가 작업 중인 프로젝트를 저장해두고 나중에 다시 불러와서 수정하고 싶다. 브라우저 스토리지에 프로젝트를 저장하고, 저장된 프로젝트 목록에서 선택하여 불러올 수 있다.

**Why this priority**: 작업 연속성을 제공하지만, 첫 사용시에는 한 번에 완성하는 경우가 많아 핵심 기능 이후에 구현해도 된다.

**Independent Test**: 프로젝트 생성 → 저장 → 새 프로젝트 → 저장된 프로젝트 불러오기 → 이어서 편집으로 저장/불러오기 기능을 검증한다.

**Acceptance Scenarios**:

1. **Given** 대화가 구성된 프로젝트, **When** "저장" 버튼을 클릭, **Then** 현재 상태가 브라우저 스토리지에 저장되고 성공 메시지가 표시된다
2. **Given** 저장된 프로젝트가 1개 이상 있는 상태, **When** "프로젝트 목록" 버튼을 클릭, **Then** 저장된 프로젝트 목록(제목, 날짜)이 표시된다
3. **Given** 프로젝트 목록이 표시된 상태, **When** 특정 프로젝트를 선택, **Then** 해당 프로젝트가 에디터에 로드되어 이어서 편집할 수 있다
4. **Given** 저장된 프로젝트, **When** 프로젝트 목록에서 삭제 버튼 클릭, **Then** 해당 프로젝트가 스토리지에서 삭제된다

---

### Edge Cases

- **빈 대화 이미지 저장**: 메시지가 0개인 상태에서 이미지 저장 시 → 빈 캔버스라도 저장 가능 (상단바, 배경만 있는 이미지)
- **매우 긴 메시지**: 500자 이상의 메시지 입력 시 → 말풍선이 자동으로 여러 줄로 확장
- **대량 메시지**: 100개 이상의 메시지 → 스크롤 가능한 캔버스로 표시, 이미지 저장 시 전체 대화 포함
- **브라우저 스토리지 용량 초과**: 저장 용량 초과 시 → 사용자에게 용량 부족 알림 및 오래된 프로젝트 삭제 안내
- **이미지 업로드 실패**: 프로필 이미지 업로드 중 오류 → 기본 프로필 아이콘 유지, 재시도 안내
- **지원하지 않는 브라우저**: 이미지 export 기능이 지원되지 않는 브라우저 → 기능 제한 안내 메시지 표시
- **잘못된 프로젝트 데이터**: 스토리지의 데이터가 손상된 경우 → 해당 프로젝트는 "손상됨"으로 표시, 삭제만 가능

---

## Requirements *(mandatory)*

### Functional Requirements

#### 대화 캔버스

- **FR-001**: 시스템은 메신저 스타일의 대화 UI를 캔버스에 렌더링할 수 있어야 한다
- **FR-002**: 캔버스는 상단 바(앱 이름, 방 제목, 시간, 배터리, Wi-Fi 아이콘)를 표시할 수 있어야 한다
- **FR-003**: 캔버스는 설정된 배경색 또는 배경 이미지를 표시할 수 있어야 한다

#### 메시지 편집

- **FR-004**: 사용자는 새 메시지를 추가할 수 있어야 한다 (발화자 선택, 텍스트 입력)
- **FR-005**: 사용자는 기존 메시지를 수정할 수 있어야 한다
- **FR-006**: 사용자는 메시지를 삭제할 수 있어야 한다
- **FR-007**: 사용자는 메시지 순서를 변경할 수 있어야 한다 (드래그 앤 드롭 또는 위/아래 버튼)
- **FR-008**: 시스템은 3가지 이상의 메시지 타입을 지원해야 한다 (일반, 강조, 시스템 메시지)

#### 발화자 관리

- **FR-009**: 시스템은 2~10명의 발화자를 지원해야 한다 (1:1 대화부터 중규모 그룹 채팅까지)
- **FR-010**: 사용자는 발화자별 이름을 설정할 수 있어야 한다
- **FR-011**: 사용자는 발화자별 프로필 이미지를 설정할 수 있어야 한다 (업로드 또는 기본 제공)
- **FR-012**: 시스템은 발화자에 따라 메시지 정렬 방향(좌/우)을 자동 적용해야 한다

#### 테마/프리셋

- **FR-013**: 시스템은 3가지 이상의 테마 프리셋을 제공해야 한다 (카카오톡, 디스코드, 인스타그램 DM 스타일)
- **FR-014**: 테마 변경 시 말풍선 색상, 배경색, 폰트, 상단 바 스타일이 일괄 변경되어야 한다
- **FR-015**: 테마 변경 시 기존 메시지 내용은 유지되어야 한다
- **FR-016**: 사용자는 테마 프리셋과 별개로 개별 스타일 요소를 커스텀할 수 있어야 한다

#### 이미지 Export

- **FR-017**: 시스템은 현재 캔버스를 PNG 형식으로 저장할 수 있어야 한다
- **FR-018**: 시스템은 현재 캔버스를 WebP 형식으로 저장할 수 있어야 한다 (선택 옵션)
- **FR-019**: 저장된 이미지는 캔버스에 표시된 모든 요소(상단바, 메시지, 배경)를 포함해야 한다
- **FR-025**: 사용자는 이미지 Export 시 해상도를 선택할 수 있어야 한다 (1x, 2x, 3x) *(MVP: 2x 고정, 해상도 선택 UI는 Phase 8 이후)*

#### 프로젝트 저장/불러오기

- **FR-020**: 시스템은 프로젝트를 브라우저 스토리지에 저장할 수 있어야 한다
- **FR-026**: 시스템은 프로젝트 변경 시 자동으로 저장해야 한다 (debounce 적용으로 성능 최적화)
- **FR-021**: 시스템은 저장된 프로젝트 목록을 표시할 수 있어야 한다
- **FR-022**: 사용자는 저장된 프로젝트를 불러올 수 있어야 한다
- **FR-023**: 사용자는 저장된 프로젝트를 삭제할 수 있어야 한다
- **FR-024**: 프로젝트 데이터는 제목, 생성일, 수정일, 메시지 목록, 테마 설정을 포함해야 한다

### Key Entities

- **Project**: 하나의 대화 프로젝트. 고유 ID, 제목, 생성일, 수정일, 메시지 목록, 테마 설정, 발화자 프로필 정보를 포함
- **Message**: 개별 메시지. 고유 ID, 발화자 ID, 텍스트 내용, 메시지 타입(일반/강조/시스템), 타임스탬프(선택적 표시), 순서를 포함
- **Speaker**: 대화 참여자. 고유 ID, 이름, 프로필 이미지, 정렬 방향(좌/우)을 포함
- **Theme**: 스타일 프리셋. 배경색/이미지, 말풍선 색상(발신/수신), 텍스트 색상, 폰트 설정, 상단 바 스타일을 포함

---

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 새 프로젝트 생성부터 이미지 다운로드까지 3분 이내에 완료할 수 있어야 한다
- **SC-002**: 테마 변경 시 캔버스가 1초 이내에 새 스타일로 렌더링되어야 한다
- **SC-003**: 100개 메시지가 포함된 대화도 스크롤 및 편집 시 버벅임 없이 동작해야 한다
- **SC-004**: 이미지 저장 버튼 클릭 후 5초 이내에 파일 다운로드가 시작되어야 한다
- **SC-005**: 저장된 프로젝트 불러오기가 2초 이내에 완료되어야 한다
- **SC-006**: 처음 사용하는 사용자도 도움말 없이 기본 기능(메시지 추가, 테마 변경, 이미지 저장)을 사용할 수 있어야 한다

---

## Constraints & Assumptions

### Hard Constraints (하드 룰)

1. **Python 금지 (MVP 범위)**: 이 기능(002-chat-editor-mvp) 내에서는 Python 런타임, 패키지, 코드 신규 생성 금지. 기존 Python 코드는 `legacy/`로 이동하여 MVP 실행 플로우에서 완전 분리. (참고: Constitution에 따라 AI/ML 서브시스템에서는 Python 허용됨)
2. **단일 JS/TS 스택**: 프론트/백엔드 모두 TypeScript + Node.js 기반으로 통일
3. **MVP는 프론트엔드 SPA만**: 백엔드/DB는 클라우드 저장, 공유 링크가 필요해질 때 추가

### Assumptions (가정)

- 사용자는 모던 브라우저(Chrome, Firefox, Safari, Edge 최신 버전)를 사용한다
- 사용자는 이미지 저장 기능을 위해 파일 다운로드 권한을 허용한다
- 브라우저 localStorage는 최소 5MB 이상의 용량을 지원한다
- 프로필 이미지 업로드 시 사용자가 적절한 크기(10MB 이하)의 이미지를 사용한다
- 사용자는 데스크톱 환경에서 주로 사용한다 (모바일 최적화는 v2 범위)

### Out of Scope (v2 이후)

- 디스코드/텔레그램/카톡/인스타 실제 API 연동
- Upstage/LLM AI 기반 대화 생성
- 사용자 계정 및 로그인 시스템
- 클라우드 저장 및 공유 링크 생성
- 유료 플랜 및 결제 시스템
- 협업 기능 (실시간 동시 편집)
- 모바일 앱 또는 모바일 최적화 UI

---

## Dependencies

- **기존 레포지토리 리팩토링**: Python/Discord 에이전트 코드를 `legacy/`로 분리하고 MVP 빌드 플로우에서 제외해야 함
- **이미지 Export 라이브러리**: DOM을 이미지로 변환하는 기능 필요 (예: html-to-image, html2canvas)
- **드래그 앤 드롭 라이브러리**: 메시지 순서 변경을 위한 DnD 기능 필요 (예: dnd-kit, react-beautiful-dnd)
