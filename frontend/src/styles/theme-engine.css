/* ============================================================
   TalkStudio Theme Engine
   CSS Variables for Multi-Platform Chat Themes
   ============================================================ */

/* ============================================================
   BASE LAYER - Design Tokens
   ============================================================ */
@layer base {
  :root {
    /* Base spacing scale */
    --spacing-xs: 0.25rem;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;

    /* Border radius scale */
    --radius-sm: 0.25rem;
    --radius-md: 0.5rem;
    --radius-lg: 1rem;
    --radius-xl: 1.25rem;
    --radius-full: 9999px;

    /* Typography */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;

    /* Transitions */
    --transition-fast: 150ms ease;
    --transition-normal: 250ms ease;

    /* Default theme variables (Kakao) */
    --chat-bg: #b2c7d9;
    --chat-header-bg: #b2c7d9;
    --chat-header-text: #3d3d3d;

    --bubble-me-bg: #fee500;
    --bubble-me-text: #3d3d3d;
    --bubble-me-radius: 1rem;

    --bubble-other-bg: #ffffff;
    --bubble-other-text: #3d3d3d;
    --bubble-other-radius: 1rem;

    --bubble-system-bg: rgba(0, 0, 0, 0.1);
    --bubble-system-text: #666666;

    --avatar-size: 2.5rem;
    --avatar-radius: 0.75rem;

    --time-text: #888888;
    --time-size: 0.6875rem;

    --read-indicator: #3d3d3d;
    --unread-count-bg: #ff4444;
    --unread-count-text: #ffffff;

    --status-bar-bg: #000000;
    --status-bar-text: #ffffff;

    --input-bg: #ffffff;
    --input-text: #3d3d3d;
    --input-placeholder: #999999;
    --input-border: #e0e0e0;
  }

  /* ============================================================
     KAKAO TALK THEME
     ============================================================ */
  [data-theme="kakao"] {
    --chat-bg: #b2c7d9;
    --chat-header-bg: #b2c7d9;
    --chat-header-text: #3d3d3d;
    --chat-header-border: rgba(0, 0, 0, 0.1);

    --bubble-me-bg: #fee500;
    --bubble-me-text: #3d3d3d;
    --bubble-me-radius: 1rem;
    --bubble-me-tail: true;

    --bubble-other-bg: #ffffff;
    --bubble-other-text: #3d3d3d;
    --bubble-other-radius: 1rem;

    --bubble-system-bg: rgba(0, 0, 0, 0.1);
    --bubble-system-text: #666666;
    --bubble-system-radius: 1rem;

    --avatar-size: 2.5rem;
    --avatar-radius: 0.75rem;
    --avatar-border: none;

    --time-text: #888888;
    --time-size: 0.6875rem;

    --read-indicator: #3d3d3d;
    --read-indicator-size: 0.625rem;

    --name-text: #555555;
    --name-size: 0.75rem;
    --name-weight: 600;

    --font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Pretendard", sans-serif;
  }

  /* ============================================================
     INSTAGRAM DM THEME
     ============================================================ */
  [data-theme="instagram"] {
    --chat-bg: #ffffff;
    --chat-header-bg: #ffffff;
    --chat-header-text: #262626;
    --chat-header-border: #dbdbdb;

    --bubble-me-bg: #3797f0;
    --bubble-me-text: #ffffff;
    --bubble-me-radius: 1.375rem;

    --bubble-other-bg: #efefef;
    --bubble-other-text: #262626;
    --bubble-other-radius: 1.375rem;

    --bubble-system-bg: transparent;
    --bubble-system-text: #8e8e8e;
    --bubble-system-radius: 0;

    --avatar-size: 2rem;
    --avatar-radius: 9999px;
    --avatar-border: 1px solid #dbdbdb;

    --time-text: #8e8e8e;
    --time-size: 0.6875rem;

    --read-indicator: #8e8e8e;
    --read-indicator-size: 0.625rem;

    --name-text: #262626;
    --name-size: 0.8125rem;
    --name-weight: 600;

    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;

    /* Instagram specific */
    --gradient-start: #833ab4;
    --gradient-middle: #fd1d1d;
    --gradient-end: #fcb045;
  }

  /* ============================================================
     TELEGRAM THEME
     ============================================================ */
  [data-theme="telegram"] {
    --chat-bg: #0e1621;
    --chat-header-bg: #17212b;
    --chat-header-text: #ffffff;
    --chat-header-border: rgba(255, 255, 255, 0.1);

    --bubble-me-bg: #2b5278;
    --bubble-me-text: #ffffff;
    --bubble-me-radius: 0.875rem;

    --bubble-other-bg: #182533;
    --bubble-other-text: #ffffff;
    --bubble-other-radius: 0.875rem;

    --bubble-system-bg: rgba(255, 255, 255, 0.1);
    --bubble-system-text: #8b9198;
    --bubble-system-radius: 0.75rem;

    --avatar-size: 2.5rem;
    --avatar-radius: 9999px;
    --avatar-border: none;

    --time-text: rgba(255, 255, 255, 0.5);
    --time-size: 0.6875rem;

    --read-indicator: #4fae4e;
    --read-indicator-size: 0.75rem;

    --name-text: #6ab3f3;
    --name-size: 0.8125rem;
    --name-weight: 500;

    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;

    /* Telegram specific */
    --link-color: #6ab3f3;
  }

  /* ============================================================
     DISCORD THEME
     ============================================================ */
  [data-theme="discord"] {
    --chat-bg: #313338;
    --chat-header-bg: #313338;
    --chat-header-text: #f2f3f5;
    --chat-header-border: #232428;

    --bubble-me-bg: transparent;
    --bubble-me-text: #dbdee1;
    --bubble-me-radius: 0;

    --bubble-other-bg: transparent;
    --bubble-other-text: #dbdee1;
    --bubble-other-radius: 0;

    --bubble-system-bg: transparent;
    --bubble-system-text: #949ba4;
    --bubble-system-radius: 0;

    --avatar-size: 2.5rem;
    --avatar-radius: 9999px;
    --avatar-border: none;

    --time-text: #949ba4;
    --time-size: 0.6875rem;

    --read-indicator: transparent;
    --read-indicator-size: 0;

    --name-text: #f2f3f5;
    --name-size: 1rem;
    --name-weight: 500;

    --font-family: "Noto Sans KR", "Noto Sans", -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif;

    /* Discord specific */
    --mention-bg: rgba(88, 101, 242, 0.3);
    --mention-text: #c9cdfb;
    --link-color: #00aff4;
    --timestamp-hover-bg: #232428;
  }

  /* ============================================================
     iMESSAGE THEME
     ============================================================ */
  [data-theme="imessage"] {
    --chat-bg: #ffffff;
    --chat-header-bg: #f6f6f6;
    --chat-header-text: #000000;
    --chat-header-border: #c8c8c8;

    --bubble-me-bg: #007aff;
    --bubble-me-text: #ffffff;
    --bubble-me-radius: 1.125rem;

    --bubble-other-bg: #e5e5ea;
    --bubble-other-text: #000000;
    --bubble-other-radius: 1.125rem;

    --bubble-system-bg: transparent;
    --bubble-system-text: #8e8e93;
    --bubble-system-radius: 0;

    --avatar-size: 0;
    --avatar-radius: 0;
    --avatar-border: none;

    --time-text: #8e8e93;
    --time-size: 0.6875rem;

    --read-indicator: #8e8e93;
    --read-indicator-size: 0.6875rem;

    --name-text: #000000;
    --name-size: 0.875rem;
    --name-weight: 600;

    --font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;

    /* iMessage specific */
    --sms-bubble-bg: #34c759;
    --delivered-text: #8e8e93;
  }

  /* Dark mode variants */
  [data-theme="instagram"].dark {
    --chat-bg: #000000;
    --chat-header-bg: #000000;
    --chat-header-text: #f5f5f5;
    --chat-header-border: #262626;

    --bubble-other-bg: #262626;
    --bubble-other-text: #f5f5f5;
  }

  [data-theme="imessage"].dark {
    --chat-bg: #000000;
    --chat-header-bg: #1c1c1e;
    --chat-header-text: #ffffff;
    --chat-header-border: #38383a;

    --bubble-other-bg: #262628;
    --bubble-other-text: #ffffff;

    --time-text: #98989d;
  }
}

/* ============================================================
   COMPONENT LAYER - Reusable Components
   ============================================================ */
@layer components {
  /* Chat Container */
  .chat-container {
    background-color: var(--chat-bg);
    font-family: var(--font-family);
    min-height: 100%;
    transition: background-color var(--transition-normal);
  }

  /* Chat Header */
  .chat-header {
    background-color: var(--chat-header-bg);
    color: var(--chat-header-text);
    border-bottom: 1px solid var(--chat-header-border);
    padding: var(--spacing-sm) var(--spacing-md);
  }

  /* Message Bubble Base */
  .bubble {
    padding: var(--spacing-sm) var(--spacing-md);
    max-width: 70%;
    word-wrap: break-word;
    transition: background-color var(--transition-fast);
  }

  /* My Messages */
  .bubble-me {
    background-color: var(--bubble-me-bg);
    color: var(--bubble-me-text);
    border-radius: var(--bubble-me-radius);
    margin-left: auto;
  }

  /* Other's Messages */
  .bubble-other {
    background-color: var(--bubble-other-bg);
    color: var(--bubble-other-text);
    border-radius: var(--bubble-other-radius);
  }

  /* System Messages */
  .bubble-system {
    background-color: var(--bubble-system-bg);
    color: var(--bubble-system-text);
    border-radius: var(--bubble-system-radius);
    text-align: center;
    font-size: var(--font-size-sm);
    padding: var(--spacing-xs) var(--spacing-sm);
  }

  /* Avatar */
  .chat-avatar {
    width: var(--avatar-size);
    height: var(--avatar-size);
    border-radius: var(--avatar-radius);
    border: var(--avatar-border);
    object-fit: cover;
  }

  /* Speaker Name */
  .speaker-name {
    color: var(--name-text);
    font-size: var(--name-size);
    font-weight: var(--name-weight);
    margin-bottom: var(--spacing-xs);
  }

  /* Timestamp */
  .message-time {
    color: var(--time-text);
    font-size: var(--time-size);
  }

  /* Read Indicator */
  .read-indicator {
    color: var(--read-indicator);
    font-size: var(--read-indicator-size);
  }

  /* Kakao-specific bubble tail */
  [data-theme="kakao"] .bubble-me {
    border-top-right-radius: 0.25rem;
  }

  [data-theme="kakao"] .bubble-other {
    border-top-left-radius: 0.25rem;
  }

  /* iMessage bubble variations */
  [data-theme="imessage"] .bubble-me:first-of-type {
    border-bottom-right-radius: 0.25rem;
  }

  [data-theme="imessage"] .bubble-me:last-of-type {
    border-top-right-radius: var(--bubble-me-radius);
  }

  /* Discord message style (no bubbles) */
  [data-theme="discord"] .message-row {
    padding: 0.125rem var(--spacing-md);
  }

  [data-theme="discord"] .message-row:hover {
    background-color: var(--timestamp-hover-bg);
  }

  [data-theme="discord"] .bubble {
    background: transparent;
    padding: 0;
    max-width: 100%;
  }

  /* Telegram checkmarks */
  [data-theme="telegram"] .read-indicator.read {
    color: var(--read-indicator);
  }

  [data-theme="telegram"] .read-indicator.sent {
    color: var(--time-text);
  }
}

/* ============================================================
   UTILITIES LAYER
   ============================================================ */
@layer utilities {
  /* Hide avatar for iMessage */
  [data-theme="imessage"] .chat-avatar {
    display: none;
  }

  /* Instagram gradient border for stories */
  .instagram-story-ring {
    background: linear-gradient(
      45deg,
      var(--gradient-end),
      var(--gradient-middle),
      var(--gradient-start)
    );
    padding: 2px;
    border-radius: 9999px;
  }

  /* Discord mention highlight */
  [data-theme="discord"] .mention {
    background-color: var(--mention-bg);
    color: var(--mention-text);
    border-radius: 0.1875rem;
    padding: 0 0.125rem;
  }

  /* Telegram link style */
  [data-theme="telegram"] a {
    color: var(--link-color);
  }

  /* Discord link style */
  [data-theme="discord"] a {
    color: var(--link-color);
  }

  /* Status bar styles */
  .status-bar {
    background-color: var(--status-bar-bg);
    color: var(--status-bar-text);
  }

  /* Theme transition */
  .theme-transition {
    transition:
      background-color var(--transition-normal),
      color var(--transition-normal),
      border-color var(--transition-normal);
  }
}
